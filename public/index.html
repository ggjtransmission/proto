<!DOCTYPE html>
<html>
<head>
   <title>
      Proto Game!
   </title>
   <script src="http://code.jquery.com/jquery-2.2.4.min.js"></script>
   <script type="text/javascript">
      s = new WebSocket("ws://"+location.hostname+":" + location.port);

      s.onopen = function(){
         console.log("Opened Socket");
      }

      s.onclosed = function(){
         console.log("Closed Socket");
      }

      s.onmessage = function(m)
      {
         var data = JSON.parse(m.data);
         processMessage(data);
      }

      function processMessage(data)
      {
         switch(data.type)
         {
            case "time":
            // console.log("update time");
               updateTime(data.message);
            break;
            case "register":

            break;
         }
      }



      //Adds a user to the game.
      function register() {
         var messageObject = {
            type: "register",
            name: $("#player_name").val()
         }
         s.send(JSON.stringify(messageObject));
      }

      function sendStart(){
            var messageObject = {
            type: "start",
         }
         s.send(JSON.stringify(messageObject));
      }

      function updateTime(time){
         var min = Math.floor(time / 60);
         var sec = time - min * 60;
         var prettyTime = min + ":" + sec;
         $("#timeRemaining").html(prettyTime);
      }

      $(document).ready(function(){
         $(register_button).click(function()
         {
            register();
         })

         $(start_game).click(function(){
            sendStart();
         })
      })

   </script>
</head>
<body>
   Welcome to <i>Plague Party!</i>

   <p>Enter Your name: <input id="player_name" type="text" name="name"/></p>
   <button id="register_button">Register</button>


   <div id="timeRemaining"></div>
   <button id="start_game">Start Game</button>
</body>
</html>